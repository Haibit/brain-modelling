%% exp08_atlas_roi

%% load the atlas
matlab_dir = userpath;
pathstr = fullfile(matlab_dir(1:end-1),'fieldtrip-20160128','template','atlas','aal');
atlas_file = fullfile(pathstr,'ROI_MNI_V4.nii');

atlas = ft_read_atlas(atlas_file);

%% print labels
%disp(atlas.tissuelabel)
for i=1:length(atlas.tissuelabel)
    fprintf('%s\n',atlas.tissuelabel{i});
end

%% print specific labels
% pattern = 'Precentral.*';
pattern = 'Frontal.*';
matches = regexpmatchlist(atlas.tissuelabel, pattern);
for i=1:length(matches)
    fprintf('%s\n',matches{i})
end

%% plot single roi

% pattern = 'Precentral.*';
% pattern = 'Frontal_Sup_Medial_L';
% pattern = 'Precu.*';
pattern = 'Vermis.*';
matches = regexpmatchlist(atlas.tissuelabel, pattern);
plot_atlas(atlas,'roi',matches);

name = strrep(pattern,'.*','');
title(name);

%% plot rois

patterns = {...
    'Precentral.*',...
    'Frontal.*',...
    'Rolandic.*',...
    'Supp.*',...
    'Olfactory.*',...
    'Rectus.*',...
    'Insula.*',...
    'Cingulum.*',...
    'Hippocampus.*',...
    'ParaHippocampal.*',...
    'Cuneus.*',...
    'Occiptal.*',...
    'Fusiform.*',...
    'Postcentral.*',...
    'Parietal.*',...
    'SupraMarginal.*',...
    'Angular.*',...
    'Precuneus.*',...
    'Paracentral.*',...
    'Caudate.*',...
    'Putamen.*',...
    'Pallidum.*',...
    'Thalamus.*',...
    'Hesch.*',...
    'Temporal.*',...
    'Cerebelum.*',...
    'Vermis.*',...
    };

for i=1:length(patterns)
    matches = regexpmatchlist(atlas.tissuelabel, patterns{i});
    plot_atlas(atlas,'roi',matches);
    
    name = strrep(patterns{i},'.*','');
    title(name);
end

%% plot multiple labels

rois = {...
    'Temporal_Sup_R',...
    'Temporal_Pole_Sup_R',...
    'Temporal_Mid_R',...
    'Temporal_Pole_Mid_R',...
    'Temporal_Inf_R',...
    'Heschl_R',...
    };

% plot ROIs separately
for i=1:length(rois)
   plot_atlas(atlas,'roi',{rois{i}});
   name = strrep(rois{i},'_',' ');
    title(name);
end

% plot ROIs together
plot_atlas(atlas,'roi',rois);